<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Subs Check Lite</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background-color: #ffffff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            text-align: center;
            max-width: 800px;
            width: 100%;
        }

        .title {
            font-size: 64px;
            font-weight: bold;
            margin-bottom: 16px;
            letter-spacing: 4px;
        }

        .title .bracket {
            font-size: 72px;
        }

        .title .text {
            font-size: 48px;
        }

        .status {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 18px;
        }

        .links {
            font-size: 14px;
            line-height: 2;
        }

        .link-item {
            color: #333;
            text-decoration: none;
            display: inline-block;
            padding: 0 8px;
        }

        .link-item.disabled {
            color: #999;
            cursor: not-allowed;
            text-decoration: none;
        }

        .separator {
            margin: 0 12px;
            color: #999;
        }

        .stats {
            font-size: 14px;
            line-height: 1.8;
            margin-bottom: 8px;
        }

        .stats-label {
            color: #666;
        }

        .stats-value {
            font-weight: bold;
        }

        .stats-value.enabled {
            color: #22c55e;
        }

        .stats-value.disabled {
            color: #ef4444;
        }

        .stats-value.blue {
            color: #3b82f6;
        }

        .list {
            font-size: 13px;
            line-height: 1.6;
            word-break: break-all;
        }

        @media (max-width: 600px) {
            .title {
                font-size: 36px;
            }
            .status {
                font-size: 20px;
            }
            .links,
            .stats,
            .list {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title"><span class="bracket"></span>[</span> <span class="text">Sub Check Lite</span> <span class="bracket">]</span></div>
        <div class="status">Service is running</div>
        
        <div class="links">
            <a href="/v2ray" target="_blank" class="link-item" id="v2rayLink">V2ray Subscription</a>
            <span class="separator">|</span>
            <a href="/sub" target="_blank" class="link-item">Clash Subscription</a>
        </div>

        <div class="links">
            <a href="/rule" target="_blank" class="link-item">Clash Subscription Recommendation Rules</a>
        </div>

        <div class="stats" id="statsContainer">
            <span class="stats-label">Nodes:</span> <span class="stats-value blue" id="nodes">Loading...</span>
            <span class="separator">|</span>
            <span class="stats-label">Media Check:</span> <span class="stats-value" id="mediaCheck">Loading...</span>
            <span class="separator">|</span>
            <span class="stats-label">V2ray Conversion:</span> <span class="stats-value" id="v2raySub">Loading...</span>
        </div>

        <div class="list">
            <div id="typesContainer">Protocol Types Loading...</div>
            <div id="countriesContainer">Node Countries Loading...</div>
        </div>
    </div>

    <script>
        fetch('/sub/stats.json')
            .then(res => res.json())
            .then(data => {
                const nodesEl = document.getElementById('nodes');
                const mediaCheckEl = document.getElementById('mediaCheck');
                const v2raySubEl = document.getElementById('v2raySub');
                const v2rayLinkEl = document.getElementById('v2rayLink');
                const typesEl = document.getElementById('typesContainer');
                const countriesEl = document.getElementById('countriesContainer');

                nodesEl.textContent = data.nodes || 0;
                
                mediaCheckEl.textContent = data['media-check'] ? 'Enabled' : 'Disabled';
                mediaCheckEl.className = 'stats-value ' + (data['media-check'] ? 'enabled' : 'disabled');
                
                v2raySubEl.textContent = data['v2ray-subscription'] ? 'Enabled' : 'Disabled';
                v2raySubEl.className = 'stats-value ' + (data['v2ray-subscription'] ? 'enabled' : 'disabled');

                if (!data['v2ray-subscription']) {
                    v2rayLinkEl.classList.add('disabled');
                    v2rayLinkEl.removeAttribute('href');
                }

                const types = data.types || {};
                const typesText = Object.entries(types)
                    .map(([type, count]) => `${type}: ${count}`)
                    .join(' | ');
                typesEl.textContent = typesText || 'Protocol Types: None';

                const countries = data.countries || {};
                const countriesText = Object.entries(countries)
                    .map(([code, count]) => `${code}: ${count}`)
                    .join(' | ');
                countriesEl.textContent = countriesText || 'Node Countries: None';
            })
            .catch(err => {
                console.error('加载 stats.json 失败:', err);
                document.getElementById('nodes').textContent = 'Failed';
                document.getElementById('mediaCheck').textContent = 'Failed';
                document.getElementById('v2raySub').textContent = 'Failed';
                document.getElementById('typesContainer').textContent = 'Protocol Types: Failed';
                document.getElementById('countriesContainer').textContent = 'Node Countries: Failed';
            });
    </script>
</body>
</html>
